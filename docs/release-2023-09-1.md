# RDKit 2023.09.1 がリリースされました
2023年10月14日に RDKit 2023.09.1 がリリースされました。この記事では新バージョンの重要な変更点を紹介します。より詳細な情報を知りたい方はリリースノートの原文 ([2023_09_1 (Q3 2023) Release](https://github.com/rdkit/rdkit/releases/tag/Release_2023_09_1))をご確認ください。

## リリースノートより
### ハイライト
- 新しいRascalMCESのコードにより分子ペアの最大共通部分構造を求める非常に高速な実装が追加されました。（訳注: [公式ブログに詳しい解説があります](https://greglandrum.github.io/rdkit-blog/posts/2023-11-08-introducingrascalmces.html)）
- RDKitコアが「一般化部分構造検索」をサポートするようになりました。これによりリンクノードや可変接続点、互変異性体クエリなどを部分構造検索時に考慮しやすくなりました。この機能はPostgreSQLカートリッジでもサポートされています。
- RDKitがMRVファイルの読み書きに対応しました。

### 後方互換性のない変更
- CDXMLパーサーが合理的な座標と、他のRDKitファイルパーサーと同じ座標軸を持つ分子を返すようになりました。
- `JSMol` と `JSReaction` オブジェクトを返す全てのメソッドが、妥当なオブジェクトの生成に失敗したときに `nullptr` （JavaScriptでは `null`）を返すようになりました（以前は`is_valid()` メソッドを呼んだときに`false`が返ってくるオブジェクトを生成していました）。この新しい実装により無効なオブジェクトに対して `delete()` を呼ぶオーバーヘッドを回避することができるようになります。これは [`rdkit-js` のGitHubレポジトリでの公開議論で承認されました](https://github.com/rdkit/rdkit-js/discussions/336)。
- JS MinimalLibにおいて、`MolIterator` は `MolList` に改名されました。これは、`at()`、`append()`、`insert()`、`pop()`メソッドを含むようになったため `MolIterator` では不適当になったためです。 今まではこのクラスにコンストラクタがなかったため、この変更による既存のJavaScriptコードへの影響は軽微です。JavaScriptコードを更新する必要があるのは `JSMol::get_frags()` の返り値をパースする箇所だけです。この関数の返り値は `molIterator` と `mappings` の二つのキーを持つオブジェクトから構成されます。`molIterator` キーは `molList` に改名されました。
- ユーザー設定可能な `MCSParameters::FinalMatchChecker` 関数は、ビルトインの `FinalMatchChecker` 関数の後に呼び出されるようになりました。
ビルトインの `FinalMatchChecker` 関数の代わりに呼び出されるのではありません。これは設計上の欠陥であり、修正する価値があります。
- `MCSParameters::Timeout` を0に設定することは、MCSがすぐに取り消されて意味のない0秒のタイムアウトではなく、タイムアウトなしを意味するようになりました。
- `MCSParameters::MatchRingFusionStrict` が `true` のときに `FindMCS` によって生成されるSMARTS文字列は、より特異的な部分構造へのマッチを確実にするために、必要に応じてring membershipクエリーを含むようになりました。（訳注: ring membershipとは `R<n>` のようなSMARTSを指します cf. [SMARTS文法](https://www.daylight.com/dayhtml/doc/theory/theory.smarts.html)）
- verboseモードのMCSで表示される統計において、`SingleBondExcluded` は、混乱を避けるために `IndividualBondExcluded` に改名されました。これは化学においてsingle bondは異なる意味を持つためです。
- `GetProp()` の呼び出しで型変換に失敗したときのエラーメッセージが、コンパイラごとに若干異なるようになりました。"boost::bad_any cast" を常に含める代わりに、`[B,b]ad any[ \ ,_]cast` という正規表現でマッチさせる必要があります。（訳注: "boost::bad_any cast" とは `boost::any_cast` が悪いものであることを示す表現なのだと思いますが、検索しても[RDKitの過去のissue](https://github.com/rdkit/rdkit/issues/717)くらいでしか使われていない表現だったので真意は不明です）
- DetermineBondsの内部で接続性を求める関数は、デフォルトでより効率的な方法を使用するようになりました。以前の動作に戻すには、useVdw引数をTrueに設定してください。
- 2次元構造から原子の立体化学を認識するアルゴリズムが書き直されました。新しいアルゴリズムはより正確であり、その結果このリリースでは認識される立体化学が以前のリリースと干異なります。
- CXSMILESが生成されていない場合、SMILESのカノニカル化処理でステレオグループに関する情報が使用されなくなりました。

### 新機能及び改善・バグ修正・クリーンアップ・
（訳注: 省略します。ご興味のある方は[原文](https://github.com/rdkit/rdkit/releases/tag/Release_2023_09_1)をご確認ください。）

### このリリースで削除されたコード
- （2021.01 以降廃止予定となっていた）`compare`と `callback` メソッドが `rdFMCS` モジュールの `MCSProgress`・`MCSBondCompare`・`MCSAtomCompare` Python クラスから削除されました。`compare`と `callback` メソッドの両方が `__call__` に置き換えられます。
- （2021.01 以降廃止予定となっていた）`SetAtomTyper` と `SetBondTyper` メソッドが `rdFMCS` モジュールの `MCSParameters` Python クラスから削除されました。これらは読み書き可能なプロパティである `AtomTyper` と `BondTyper` でそれぞれ置き換えられます。
respectively.

### 廃止予定となったコード
- `JSMol::is_valid()` と `JSReaction::is_valid()` は廃止予定となり、常にtrueを返すようになります。これはvalidでないJSmolとJSReactionはもう存在しないためです。
- MolStandardize の Python 実装は次のリリースで削除されます。代わりに rdkit.Chem.MolStandardize.rdMolStandardize の実装を利用してください。

以上です。ドキュメントの誤りや改善点を見つけた場合はユーザー会のSlackか[GitHub](https://github.com/rdkit-users-jp/rdkit-users-jp.github.io)までご連絡ください。
